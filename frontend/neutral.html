<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Welcome! - Neutral Mode</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🔒</text></svg>">
  <link rel="stylesheet" href="styles.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
  <!-- Step 1: Introduction Page -->
  <div id="introduction-page" class="step-page active">
    <div class="step-container">
      <div class="step-header">
        <h1><i class="fas fa-graduation-cap"></i> Welcome!</h1>
        <div class="step-indicator">
          <span class="step-number">1</span>
          <span class="step-label">Introduction</span>
        </div>
      </div>
      
      <div class="step-content">
        <div class="introduction-content">
          <div class="welcome-section">
            <h2>Study Overview</h2>
            <p>Welcome to our research study on <strong>using AI in job interviews</strong>. This study explores how people interact with AI chatbots when discussing sensitive topics and making decisions about sharing personal information.</p>
            <p>As AI becomes increasingly common in professional settings, including job interviews, we want to understand how people feel about sharing their experiences and opinions on this topic. You'll have a conversation with an AI chatbot about using AI during job interviews, and we'll explore how different privacy features affect your willingness to share information.</p>
          </div>

          <!-- Read More Section -->
          <div class="read-more-section">
            <button id="read-more-toggle" class="btn btn-secondary read-more-btn">
              <i class="fas fa-chevron-down"></i> Read More About This Study
            </button>
            
            <div id="read-more-content" class="read-more-content">
              <div class="additional-study-details">
                <h3><i class="fas fa-microscope"></i> Research Background</h3>
                <p>This study is part of ongoing research at Northeastern University's Khoury College of Computer Science, investigating how people interact with AI systems in professional contexts. As AI becomes increasingly integrated into hiring processes, understanding user privacy concerns and information sharing behaviors is crucial for developing more privacy-aware AI systems.</p>
                
                <h3><i class="fas fa-users"></i> Study Objectives</h3>
                <ul>
                  <li>Understand how users perceive privacy risks when interacting with AI chatbots</li>
                  <li>Evaluate the effectiveness of different privacy protection features</li>
                  <li>Assess user comfort levels when sharing personal information with AI systems</li>
                  <li>Identify factors that influence information sharing decisions</li>
                </ul>

                <h3><i class="fas fa-clipboard-list"></i> What We're Studying</h3>
                <p>You will interact with an AI chatbot to talk about your past job experiences. The chatbot will ask you questions about your background, experiences, and opinions. We're studying how different privacy features affect your willingness to share information and your overall experience.</p>

                <h3><i class="fas fa-file-alt"></i> Official Study Documentation</h3>
                <div class="irb-link-section">
                  <p><strong>Institutional Review Board (IRB) Approval:</strong> This study has been reviewed and approved by Northeastern University's Institutional Review Board.</p>
                  <a href="https://docs.google.com/document/d/1C7o9lxRrGxu7sKr9dof-nAI6t97ZtbL7JvA3B-9qYf0/edit?tab=t.0" target="_blank" class="btn btn-primary irb-link-btn">
                    <i class="fas fa-external-link-alt"></i> View Original IRB Documentation
                  </a>
                  <p class="irb-note"><small><i class="fas fa-info-circle"></i> This link opens the official IRB approval document in a new tab.</small></p>
                </div>

                <h3><i class="fas fa-handshake"></i> Your Rights as a Participant</h3>
                <ul>
                  <li>You have the right to withdraw from the study at any time without penalty</li>
                  <li>You can skip any questions you don't want to answer</li>
                  <li>All data will be kept confidential and anonymized</li>
                  <li>You will receive compensation upon completion</li>
                  <li>You can contact the research team with any questions or concerns</li>
                </ul>

                <h3><i class="fas fa-envelope"></i> Contact Information</h3>
                <p><strong>Principal Investigator:</strong> Prof. Tianshi Li<br>
                <strong>Email:</strong> <a href="mailto:tia.li@northeastern.edu">tia.li@northeastern.edu</a></p>
                
                <p><strong>Research Assistant:</strong> Ziwen Li<br>
                <strong>Email:</strong> <a href="mailto:li.ziw@northeastern.edu">li.ziw@northeastern.edu</a></p>
                
                <p><strong>IRB Office:</strong> Northeastern University Department of Human Research<br>
                <strong>Phone:</strong> (773) 396-2327<br>
                <strong>Email:</strong> <a href="mailto:IRBReview@northeastern.edu">IRBReview@northeastern.edu</a></p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="step-actions">
        <button id="start-study-btn" class="btn btn-primary">
          <i class="fas fa-arrow-right"></i> Begin Study
        </button>
      </div>
    </div>
  </div>

  <!-- Step 2: Consent Page -->
  <div id="consent-page" class="step-page">
    <div class="step-container">
      <div class="step-header">
        <h1><i class="fas fa-user-shield"></i> Informed Consent</h1>
        <div class="step-indicator">
          <span class="step-number">2</span>
          <span class="step-label">Consent</span>
        </div>
      </div>
      
      <div class="step-content">
        <div class="consent-content">
          <div class="consent-section">
            <h2>Study Information</h2>
            <p><strong>Title:</strong> Privacy Perceptions in AI-Enhanced Job Interviews</p>
            <p><strong>Principal Investigator:</strong> Prof. Tianshi Li, Northeastern University</p>
            <p><strong>Study Duration:</strong> Approximately 15-20 minutes</p>
            <p><strong>Compensation:</strong> $2.00 USD upon completion</p>
          </div>

          <div class="consent-section">
            <h2>What You'll Do</h2>
            <ul>
              <li>Have a conversation with an AI chatbot about using AI in job interviews</li>
              <li>Answer questions about your background and experiences</li>
              <li>Complete a brief survey about your experience</li>
              <li>Optionally edit your conversation before it's shared</li>
            </ul>
          </div>

          <div class="consent-section">
            <h2>Privacy & Data Protection</h2>
            <ul>
              <li>All data will be anonymized and kept confidential</li>
              <li>Your responses will be used for research purposes only</li>
              <li>You can withdraw at any time without penalty</li>
              <li>You can skip any questions you don't want to answer</li>
            </ul>
          </div>

          <div class="consent-section">
            <h2>Your Rights</h2>
            <ul>
              <li>You have the right to withdraw from the study at any time</li>
              <li>You can contact the research team with questions</li>
              <li>You can contact the IRB office with concerns</li>
            </ul>
          </div>

          <div class="consent-checkbox">
            <label class="checkbox-container">
              <input type="checkbox" id="consent-checkbox">
              <span class="checkmark"></span>
              I have read and understand the information above. I agree to participate in this study.
            </label>
          </div>
        </div>
      </div>

      <div class="step-actions">
        <button id="consent-btn" class="btn btn-primary" disabled>
          <i class="fas fa-check"></i> I Consent to Participate
        </button>
      </div>
    </div>
  </div>

  <!-- Step 3: Qualification Page -->
  <div id="qualification-page" class="step-page">
    <div class="step-container">
      <div class="step-header">
        <h1><i class="fas fa-clipboard-check"></i> Qualification Questions</h1>
        <div class="step-indicator">
          <span class="step-number">2</span>
          <span class="step-label">Qualification</span>
        </div>
      </div>
      
      <div class="step-content">
        <div class="qualification-content">
          <div class="qualification-intro">
            <p>Please answer the following questions to ensure you qualify for this study.</p>
          </div>

          <div class="qualification-questions">
            <div class="qualification-question">
              <label for="qual-1">Are you 18 years of age or older?</label>
              <select id="qual-1" class="form-control qualification-select" required>
                <option value="">Select an answer...</option>
                <option value="yes">Yes</option>
                <option value="no">No</option>
              </select>
            </div>

            <div class="qualification-question">
              <label for="qual-2">Do you speak and understand English fluently?</label>
              <select id="qual-2" class="form-control qualification-select" required>
                <option value="">Select an answer...</option>
                <option value="yes">Yes</option>
                <option value="no">No</option>
              </select>
            </div>

            <div class="qualification-question">
              <label for="qual-3">Do you have basic experience using AI tools to help you with your job interview (e.g., ChatGPT, Claude, etc.)?</label>
              <select id="qual-3" class="form-control qualification-select" required>
                <option value="">Select an answer...</option>
                <option value="yes">Yes</option>
                <option value="no">No</option>
              </select>
            </div>
          </div>
        </div>
      </div>

      <div class="step-actions">
        <button id="back-to-consent-btn" class="btn btn-secondary">
          <i class="fas fa-arrow-left"></i> Back to Introduction
        </button>
        <button id="proceed-to-chat-btn" class="btn btn-primary">
          <i class="fas fa-arrow-right"></i> Continue
        </button>
      </div>
    </div>
  </div>

  <!-- Step 4: Main Chat Interface (Current Interface) -->
  <div id="chat-page" class="step-page">
    <div class="container sidebar-hidden">
      <!-- Header -->
      <header class="header">
        <div class="header-content">
          <div class="header-left">
            <h1 id="main-header-title"><i class="fas fa-lock"></i>Privacy Demo Study</h1>
          </div>
          <div class="header-right">
            <!-- Progress Bar -->
            <div id="progress-container" class="progress-container" style="display: none;">
              <div class="progress-info">
                <span id="progress-text" class="progress-text">Question 1 of 5</span>
                <span id="progress-percentage" class="progress-percentage">20%</span>
              </div>
              <div class="progress-bar">
                <div id="progress-fill" class="progress-fill"></div>
              </div>
            </div>
          </div>
        </div>
      </header>

      <!-- Sidebar -->
      <aside class="sidebar">
        <div class="sidebar-section">
          <h3><i class="fas fa-cog"></i> Configuration</h3>
          
          <!-- Mode Info (Fixed for Neutral Mode) -->
          <div id="mode-info" class="info-box">
            <p><strong>⚖️ Neutral Mode:</strong> Standard conversation interface</p>
          </div>

          <!-- Copy/Paste Toggle -->
          <div class="form-group">
            <label for="copy-paste-toggle">Copy & Paste:</label>
            <button id="copy-paste-toggle" class="btn btn-secondary">
              <i class="fas fa-lock"></i> Disabled
            </button>
          </div>

          <!-- Action Buttons -->
          <div class="button-group">
            <button id="reset-btn" class="btn btn-secondary">
              <i class="fas fa-redo"></i> Reset Conversation
            </button>
            <button id="exit-edit-btn" class="btn btn-warning" style="display: none;">
              <i class="fas fa-times"></i> Exit Edit Mode
            </button>
            <button id="show-congratulation-btn" class="btn btn-success">
              <i class="fas fa-trophy"></i> Show Congratulations
            </button>
            <button id="user-agent-btn" class="btn btn-info">
              <i class="fas fa-user"></i> Start User Agent
            </button>
          </div>
        </div>

        <!-- Statistics -->
        <div class="sidebar-section">
          <h3><i class="fas fa-chart-bar"></i> Statistics</h3>
          <div class="stats-grid">
            <div class="stat-item">
              <span class="stat-label">Mode:</span>
              <span id="stat-mode" class="stat-value">⚖️ Neutral</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">Messages:</span>
              <span id="stat-messages" class="stat-value">0</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">Step:</span>
              <span id="stat-step" class="stat-value">0</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">Privacy Issues:</span>
              <span id="stat-privacy" class="stat-value">0</span>
            </div>
          </div>
        </div>

        <!-- API Status -->
        <div class="sidebar-section">
          <h3><i class="fas fa-key"></i> API Status</h3>
          <div id="api-status" class="status-indicator">
            <span class="status-dot"></span>
            <span class="status-text">Checking...</span>
          </div>
          <button id="test-api-btn" class="btn btn-sm btn-secondary">
            <i class="fas fa-vial"></i> Test Connection
          </button>
          
          <!-- Audit LLM Status -->
          <div id="audit-llm-status" class="status-indicator" style="margin-top: 0.5rem;">
            <span class="status-dot"></span>
            <span class="status-text">🔍 Audit LLM: Checking...</span>
          </div>
        </div>

        <!-- App Configuration -->
        <div class="sidebar-section">
          <h3><i class="fas fa-sliders-h"></i> App Settings</h3>
          
          <!-- Sidebar Configuration -->
          <div class="form-group">
            <label for="sidebar-config-toggle">Sidebar Toggle:</label>
            <button id="sidebar-config-toggle" class="btn btn-secondary">
              <i class="fas fa-toggle-on"></i> Enabled
            </button>
          </div>
          
          <!-- Sidebar Default State -->
          <div class="form-group">
            <label for="sidebar-default-state">Default Sidebar State:</label>
            <button id="sidebar-default-state" class="btn btn-secondary">
              <i class="fas fa-eye"></i> Visible
            </button>
          </div>
          
          <!-- Persist Sidebar State -->
          <div class="form-group">
            <label for="sidebar-persist-state">Persist Sidebar State:</label>
            <button id="sidebar-persist-state" class="btn btn-secondary">
              <i class="fas fa-save"></i> Enabled
            </button>
          </div>
        </div>
      </aside>

      <!-- Main Content -->
      <main class="main-content">
        <!-- Two Column Layout for Privacy Analysis & Export Stage -->
        <div id="two-column-layout" class="two-column-layout" style="display:none;">
          <div class="left-column">
            <div class="edit-instructions" style="margin-bottom: 1rem; padding: 0.75rem; background-color: #f8f9fa; border-radius: 6px; border-left: 4px solid #28a745;">
              <p style="margin: 0; font-size: 0.9rem; color: #495057;"><i class="fas fa-edit"></i> <strong>Privacy Analysis Mode:</strong> You can edit any message in your conversation if you do not want that content shared. Click on any message to edit it.</p>
            </div>
            <div id="analysis-conversation-container" class="conversation-container">
              <div class="empty-state">
                <i class="fas fa-comment-dots"></i>
                <p>Start a conversation by typing a message below!</p>
              </div>
            </div>
          </div>
          <div class="right-column">
            <div id="privacy-analysis" class="privacy-analysis" style="display: none;">
              <div class="privacy-analysis-header">
                <h3><i class="fas fa-search"></i> Privacy Analysis Results</h3>
              </div>
              <div class="privacy-analysis-content">
                <div class="analysis-header">
                  <p>Privacy analysis has been completed on all messages. Click on red underlined text to see suggestions.</p>
                  <label style="display:block;margin:0.5em 0 1em 0;font-weight:normal;">
                    <input type="checkbox" id="privacy-filter-toggle" /> Show only messages with privacy issues
                  </label>
                </div>
                <div class="analysis-stats">
                  <div class="stat-card">
                    <span class="stat-number" id="total-messages">0</span>
                    <span class="stat-label">Total Messages</span>
                  </div>
                  <div class="stat-card">
                    <span class="stat-number" id="privacy-issues">0</span>
                    <span class="stat-label">Privacy Issues</span>
                  </div>
                </div>
                <div id="privacy-choices" class="privacy-choices">
                  <!-- Privacy choice buttons will be generated here -->
                </div>
                <div class="export-options">
                  <button id="export-comprehensive" class="btn btn-success">
                    <i class="fas fa-check"></i> Done!
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- Chat Interface (shown when not in analysis stage) -->
        <div class="chat-container">
          <div class="chat-header">
            <h2 id="chat-header-title"><i class="fas fa-comments"></i> Chat Interface</h2>
        <span id="privacy-analysis-status" style="display: none;"></span>
          </div>
          <div id="edit-instructions-chat" class="edit-instructions" style="margin-bottom: 1rem; padding: 0.75rem; background-color: #f8f9fa; border-radius: 6px; border-left: 4px solid #007bff; display: none;">
            <p style="margin: 0; font-size: 0.9rem; color: #495057;"><i class="fas fa-info-circle"></i> <strong>Edit Mode:</strong> You can edit any message in your conversation if you do not want that content shared. Click on any message to edit it.</p>
          </div>
          <div id="conversation-container" class="conversation-container">
            <div class="empty-state">
              <i class="fas fa-comment-dots"></i>
              <p>Start a conversation by typing a message below!</p>
            </div>
          </div>
          <div class="chat-input-container">
            <div class="input-group" id="chat-input-group">
              <input type="text" id="chat-input" placeholder="Type your message here..." class="form-control">
              <button id="send-btn" class="btn btn-primary">
                <i class="fas fa-paper-plane"></i> Send
              </button>
            </div>
            <div id="edit-export-container" class="edit-export-container" style="display: none;">
              <div class="edit-export-buttons">
                <button id="edit-export-btn-main" class="btn btn-primary">
                  <i class="fas fa-edit"></i> Edit & Export
                </button>
                <button id="export-direct-btn-main" class="btn btn-success">
                  <i class="fas fa-download"></i> Export Direct
                </button>
                <button id="analyze-export-btn-main" class="btn btn-warning">
                  <i class="fas fa-search"></i> Analyze & Export
                </button>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- Action Buttons Panel - Fixed Position -->
    <div class="action-buttons-panel">
      <!-- Config Button -->
      <div class="config-button-container">
        <button id="toggle-sidebar-btn" class="btn btn-secondary toggle-sidebar-btn">
          <i class="fas fa-bars"></i> Hide Config
        </button>
      </div>

      <!-- Export Buttons -->
      <div id="export-buttons" class="export-buttons-container" style="display: none;">
        <button id="edit-export-btn" class="btn btn-primary" style="display: none;">
          <i class="fas fa-edit"></i> Edit & Export
        </button>
        <button id="export-direct-btn" class="btn btn-success">
          <i class="fas fa-download"></i> Export Direct
        </button>
        <button id="analyze-export-btn" class="btn btn-warning" style="display: none;">
          <i class="fas fa-search"></i> Analyze & Export
        </button>
      </div>
    </div>
  </div>



  <!-- Privacy Popup Modal -->
  <div id="privacy-popup" class="privacy-popup">
    <div class="popup-content">
      <button class="popup-close" onclick="closePrivacyPopup()">
        <i class="fas fa-times"></i>
      </button>
      <h4 id="popup-title"></h4>
      <div id="popup-explanation"></div>
      <div id="popup-suggestion" class="suggestion-box"></div>
      <button id="popup-apply-btn" class="btn btn-success" style="display: none;">
        <i class="fas fa-check"></i> Apply This Fix
      </button>
    </div>
  </div>

  <!-- Consent Popup Modal -->
  <div id="consent-popup" class="consent-popup">
    <div class="popup-content">
      <button class="popup-close" onclick="closeConsentPopup()">
        <i class="fas fa-times"></i>
      </button>
      <h4><i class="fas fa-user-shield"></i> Research Data Sharing</h4>
      <div class="consent-explanation">
        <p>Would you like to share your original conversation for research purposes?</p>
        
        <div class="consent-section">
          <h5><i class="fas fa-info-circle"></i> What this means:</h5>
          <ul>
            <li>Your conversation with the chatbot will be used for academic research</li>
            <li>All data will be anonymized and kept confidential</li>
            <li>Your participation helps improve AI privacy protection systems</li>
          </ul>
        </div>
      </div>
      <div class="consent-actions">
        <button id="consent-agree-btn" class="btn btn-success">
          <i class="fas fa-check"></i> Yes, I agree to share
        </button>
        <button id="consent-decline-btn" class="btn btn-secondary">
          <i class="fas fa-times"></i> No, I decline
        </button>
      </div>
    </div>
  </div>

  <!-- Post-Task Survey Modal -->
  <div id="survey-popup" class="survey-popup">
    <div class="popup-content">
      <button class="popup-close" onclick="closeSurveyPopup()">
        <i class="fas fa-times"></i>
      </button>
      <h4><i class="fas fa-clipboard-list"></i> Post-Task Survey</h4>
      <div class="survey-container">
        <p class="survey-intro">Please complete this brief survey to help us understand your experience. Your responses will be included in the exported data.</p>
        
        <form id="survey-form">
          <!-- Overall Experiences (all groups) -->
<div class="survey-question">
  <label for="q1">Did you have any concerns about your privacy during or after the interview? If yes, please elaborate.</label>
  <textarea id="q1" name="q1" class="form-control" rows="4" placeholder="Please describe any privacy concerns you had..."></textarea>
</div>

<div class="survey-question">
  <label for="q2">Were there any points during the conversation where you hesitated to answer due to privacy concerns? If so, please elaborate.</label>
  <textarea id="q2" name="q2" class="form-control" rows="4" placeholder="Please describe any moments where you hesitated..."></textarea>
</div>

<!-- Overall Likert group -->
<div class="survey-question">
  <p><strong>To what extent do you agree with the following statements?<br>(1 = Strongly Disagree, 5 = Strongly Agree)</strong></p>
</div>

<div class="survey-question">
  <label for="q3">I felt comfortable sharing personal information with the chatbot.</label>
  <select id="q3" name="q3" class="form-control">
    <option value="">Select your level of agreement...</option>
    <option value="1">1 - Strongly Disagree</option>
    <option value="2">2 - Disagree</option>
    <option value="3">3 - Neutral</option>
    <option value="4">4 - Agree</option>
    <option value="5">5 - Strongly Agree</option>
  </select>
</div>

<div class="survey-question">
  <label for="q4">I would like to discuss sensitive topics in the next interview with the chatbot.</label>
  <select id="q4" name="q4" class="form-control">
    <option value="">Select your level of agreement...</option>
    <option value="1">1 - Strongly Disagree</option>
    <option value="2">2 - Disagree</option>
    <option value="3">3 - Neutral</option>
    <option value="4">4 - Agree</option>
    <option value="5">5 - Strongly Agree</option>
  </select>
</div>

<!-- Naive Mode Specific Questions -->
<div id="naive-specific-questions" class="mode-specific-questions" style="display: none;">
  <div class="survey-question">
    <label for="q5">What did you remove or change in the conversation and why?</label>
    <textarea id="q5" name="q5" class="form-control" rows="4" placeholder="Describe what you removed/changed and the reasons..."></textarea>
  </div>

  <div class="survey-question">
    <label for="q6">How comfortable do you feel about sharing your final edited version? Share how comfortable you feel and why.</label>
    <textarea id="q6" name="q6" class="form-control" rows="4" placeholder="Share how comfortable you feel and why..."></textarea>
  </div>

  <!-- Naive Likert group -->
  <div class="survey-question">
    <p><strong>To what extent do you agree with the following statements?<br>(1 = Strongly Disagree, 5 = Strongly Agree)</strong></p>
  </div>

  <div class="survey-question">
    <label for="q7">The editing features improved my sense of privacy control.</label>
    <select id="q7" name="q7" class="form-control">
      <option value="">Select your level of agreement...</option>
      <option value="1">1 - Strongly Disagree</option>
      <option value="2">2 - Disagree</option>
      <option value="3">3 - Neutral</option>
      <option value="4">4 - Agree</option>
      <option value="5">5 - Strongly Agree</option>
    </select>
  </div>

  <div class="survey-question">
    <label for="q8">I was able to clearly understand how to use the editing features to protect my privacy.</label>
    <select id="q8" name="q8" class="form-control">
      <option value="">Select your level of agreement...</option>
      <option value="1">1 - Strongly Disagree</option>
      <option value="2">2 - Disagree</option>
      <option value="3">3 - Neutral</option>
      <option value="4">4 - Agree</option>
      <option value="5">5 - Strongly Agree</option>
    </select>
  </div>

  <div class="survey-question">
    <label for="q9">The free editing made me more confident about what I shared.</label>
    <select id="q9" name="q9" class="form-control">
      <option value="">Select your level of agreement...</option>
      <option value="1">1 - Strongly Disagree</option>
      <option value="2">2 - Disagree</option>
      <option value="3">3 - Neutral</option>
      <option value="4">4 - Agree</option>
      <option value="5">5 - Strongly Agree</option>
    </select>
  </div>
</div>

<!-- Featured Mode Specific Questions -->
<div id="featured-specific-questions" class="mode-specific-questions" style="display: none;">
  <div class="survey-question">
    <label for="q10">What did you remove or change in the conversation based on the AI suggestions and why?</label>
    <textarea id="q10" name="q10" class="form-control" rows="4" placeholder="Describe what you removed/changed due to AI suggestions and why..."></textarea>
  </div>

  <div class="survey-question">
    <label for="q11">How comfortable do you feel about sharing your final edited version? Share how comfortable you feel and why.</label>
    <textarea id="q11" name="q11" class="form-control" rows="4" placeholder="Share how comfortable you feel and why..."></textarea>
  </div>

  <!-- Featured Likert group -->
  <div class="survey-question">
    <p><strong>To what extent do you agree with the following statements?<br>(1 = Strongly Disagree, 5 = Strongly Agree)</strong></p>
  </div>

  <div class="survey-question">
    <label for="q12">The AI-assisted editing improved my sense of privacy control.</label>
    <select id="q12" name="q12" class="form-control">
      <option value="">Select your level of agreement...</option>
      <option value="1">1 - Strongly Disagree</option>
      <option value="2">2 - Disagree</option>
      <option value="3">3 - Neutral</option>
      <option value="4">4 - Agree</option>
      <option value="5">5 - Strongly Agree</option>
    </select>
  </div>

  <div class="survey-question">
    <label for="q13">I was able to clearly understand how the AI suggestions helped me protect my privacy.</label>
    <select id="q13" name="q13" class="form-control">
      <option value="">Select your level of agreement...</option>
      <option value="1">1 - Strongly Disagree</option>
      <option value="2">2 - Disagree</option>
      <option value="3">3 - Neutral</option>
      <option value="4">4 - Agree</option>
      <option value="5">5 - Strongly Agree</option>
    </select>
  </div>

  <div class="survey-question">
    <label for="q14">The AI-assisted editing made me more confident about what I shared.</label>
    <select id="q14" name="q14" class="form-control">
      <option value="">Select your level of agreement...</option>
      <option value="1">1 - Strongly Disagree</option>
      <option value="2">2 - Disagree</option>
      <option value="3">3 - Neutral</option>
      <option value="4">4 - Agree</option>
      <option value="5">5 - Strongly Agree</option>
    </select>
  </div>
</div>

<!-- Demographic Questions (same for all groups) -->
<div class="survey-question">
  <label for="q15">What is your age group?</label>
  <select id="q15" name="q15" class="form-control">
    <option value="">Select your age group...</option>
    <option value="18-29">18-29</option>
    <option value="30-39">30-39</option>
    <option value="40-49">40-49</option>
    <option value="50-59">50-59</option>
    <option value=">=60">&gt;=60</option>
    <option value="Prefer not to disclose">Prefer not to disclose</option>
  </select>
</div>

<div class="survey-question">
  <label for="q16">What is your gender?</label>
  <select id="q16" name="q16" class="form-control">
    <option value="">Select your gender...</option>
    <option value="Male">Male</option>
    <option value="Female">Female</option>
    <option value="Non-binary">Non-binary</option>
    <option value="Prefer not to disclose">Prefer not to disclose</option>
  </select>
</div>

<div class="survey-question">
  <label for="q17">What is your race and ethnicity?</label>
  <select id="q17" name="q17" class="form-control">
    <option value="">Select your race and ethnicity...</option>
    <option value="Black">Black</option>
    <option value="White">White</option>
    <option value="Asian">Asian</option>
    <option value="Hispanic">Hispanic</option>
    <option value="Native American">Native American</option>
    <option value="Prefer not to disclose">Prefer not to disclose</option>
  </select>
</div>

<div class="survey-question">
  <label for="q18">What is your educational level?</label>
  <select id="q18" name="q18" class="form-control">
    <option value="">Select your educational level...</option>
    <option value="No diploma or less than 12th grade">No diploma or less than 12th grade</option>
    <option value="High school">High school</option>
    <option value="College level">College level</option>
    <option value="Associate's degree">Associate's degree</option>
    <option value="Bachelor's degree">Bachelor's degree</option>
    <option value="Graduate or professional degree">Graduate or professional degree</option>
  </select>
</div>


          <div class="survey-actions">
            <button type="submit" id="survey-submit-btn" class="btn btn-success">
                              <i class="fas fa-check"></i> Done!
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Congratulation Popup Modal -->
  <div id="congratulation-popup" class="congratulation-popup">
    <div class="popup-content">
      <button class="popup-close" onclick="closeCongratulationPopup()">
        <i class="fas fa-times"></i>
      </button>
      <h4 id="congratulation-title"><i class="fas fa-trophy"></i> 🎉 Questions Completed!</h4>
      <div class="congratulation-message" id="congratulation-message">
        Great job! You've completed all the questions. You can now proceed to the next stage.
      </div>
      <div class="congratulation-actions">
        <button id="next-stage-btn" class="btn btn-success">
          <i class="fas fa-arrow-right"></i> Next Stage
        </button>
      </div>
    </div>
  </div>

  <!-- Free Edit Reminder Popup Modal -->
  <div id="free-edit-popup" class="free-edit-popup">
    <div class="popup-content">
      <button class="popup-close" onclick="closeFreeEditPopup()">
        <i class="fas fa-times"></i>
      </button>
      <h4>Free Edit Reminder</h4>
      <div class="free-edit-message">
        <p>You can <strong>edit your conversation freely </strong>after completing the interview.</p>
        <div class="free-edit-details">
          <div class="free-edit-feature">
            <i class="fas fa-check-circle"></i>
            <span>Click on any message to edit it</span>
          </div>
          <div class="free-edit-feature">
            <i class="fas fa-check-circle"></i>
            <span>Remove or modify content you don't want to share</span>
          </div>
          <div class="free-edit-feature">
            <i class="fas fa-check-circle"></i>
            <span>Your privacy is in your control</span>
          </div>
        </div>
      </div>
      <div class="free-edit-actions">
        <button id="free-edit-understood-btn" class="btn btn-success">
          <i class="fas fa-check"></i> I Understand
        </button>
      </div>
    </div>
  </div>

  <!-- Privacy Tooltip Container -->
  <div id="privacy-tooltip-container" class="privacy-tooltip">
    <div class="tooltip-header">
      <span class="tooltip-title" id="tooltip-title">Privacy Issue</span>
    </div>
    <div class="tooltip-content">
      <div class="tooltip-explanation" id="tooltip-explanation">
        This text contains potentially sensitive information.
      </div>
      <div class="tooltip-suggestion" id="tooltip-suggestion" style="display: none;">
        <div class="safer-versions">
          <div class="version-section">
            <strong>Placeholder Version:</strong>
            <span id="tooltip-replacing-text"></span>
            <button class="tooltip-btn apply-replacing" id="tooltip-apply-replacing-btn">
              <i class="fas fa-check"></i> Apply Placeholders
            </button>
          </div>
          <div class="version-section">
            <strong>Fake Data Version:</strong>
            <span id="tooltip-abstraction-text"></span>
            <button class="tooltip-btn apply-abstraction" id="tooltip-apply-abstraction-btn">
              <i class="fas fa-check"></i> Apply Fake Data
            </button>
          </div>
        </div>
      </div>
    </div>
    <div class="tooltip-actions">
      <button class="tooltip-btn apply" id="tooltip-apply-btn" style="display: none;">
        <i class="fas fa-check"></i> Apply
      </button>
      <button class="tooltip-btn close" id="tooltip-close-btn">
        <i class="fas fa-times"></i> Close
      </button>
    </div>
  </div>

  <!-- Loading Overlay -->
  <div id="loading-overlay" class="loading-overlay">
    <div class="loading-spinner">
      <i class="fas fa-spinner fa-spin"></i>
      <p id="loading-message">Processing...</p>
      <div id="loading-notifications" class="loading-notifications">
        <!-- Progress notifications will be added here dynamically -->
      </div>
    </div>
  </div>



  <!-- Scripts -->
  <script src="api.js"></script>
  <script type="module" src="script.js"></script>
  <script>
    // Override the default mode to be 'neutral' for this page
    document.addEventListener('DOMContentLoaded', function() {
      // Set the mode to neutral when the app initializes
      if (window.app) {
        window.app.state.mode = 'neutral';
        window.app.updateUI();
        
        // Load questions and then initiate conversation
        setTimeout(async () => {
          if (window.app && window.app.state.conversationLog.length === 0) {
            console.log('Neutral mode: Loading questions and initiating conversation...');
            
            try {
              // First load the questions
              const questionsLoaded = await window.app.loadPredefinedQuestions('neutral');
              
              // Verify questions are loaded
              if (questionsLoaded) {
                const questions = window.app.state.predefinedQuestions['neutral'];
                console.log('✅ Questions loaded for neutral mode:', questions.length);
                await window.app.startQuestionConversation();
              } else {
                console.error('❌ Failed to load questions for neutral mode');
                window.app.showNotification('Failed to load questions. Please refresh the page.', 'error');
              }
            } catch (error) {
              console.error('❌ Error in neutral mode initialization:', error);
              if (window.app.showNotification) {
                window.app.showNotification('Error initializing conversation. Please refresh the page.', 'error');
              }
            }
          }
        }, 2000);
      }
      
      // Note: Neutral mode doesn't have specific survey questions to show
    });
  </script>
</body>
</html> 